
Running 1 test using 1 worker


[TEST] PHASE 1: Navigating to game
[BROWSER] [MultiplayerGame] Created room 612072 (game_1767568119536_mpv0nmc2u)
[BROWSER] [MultiplayerGame] Created room 980145 (game_1767568119539_kf9hyes2w)
[BROWSER] [MultiplayerGame] Game game_1767568119536_mpv0nmc2u started with 1 players
[BROWSER] [MultiplayerGame] disabledArtifacts calculation: {sanctuaryCount: 0, hasSanctuaryCards: false, disabled: Array(1)}
[BROWSER] [MultiplayerGame] artifactSelectorPlayer lookup: {artifactSelectorPlayerId: , playersCount: 0, playerIds: Array(0), foundPlayer: undefined, playerName: undefined}
[BROWSER] [MultiplayerGame] disabledArtifacts calculation: {sanctuaryCount: 0, hasSanctuaryCards: false, disabled: Array(1)}
[BROWSER] [MultiplayerGame] artifactSelectorPlayer lookup: {artifactSelectorPlayerId: , playersCount: 0, playerIds: Array(0), foundPlayer: undefined, playerName: undefined}
[BROWSER] [MultiplayerGame] Setting up Firebase listeners for game: game_1767568119536_mpv0nmc2u
[BROWSER] [MultiplayerGame] Setting up Firebase listeners for game: game_1767568119536_mpv0nmc2u
[BROWSER] [MultiplayerGame] Game game_1767568119539_kf9hyes2w started with 1 players
[BROWSER] [MultiplayerGame] Setting up Firebase listeners for game: game_1767568119539_kf9hyes2w
[BROWSER] [MultiplayerGame] Game update: {status: HUNTING, currentPlayerIndex: 0, isComplete: undefined}
[BROWSER] [MultiplayerGame] artifactSelectorPlayer lookup: {artifactSelectorPlayerId: , playersCount: 1, playerIds: Array(1), foundPlayer: undefined, playerName: undefined}
[BROWSER] [MultiplayerGame] Rendering PlayersFieldArea in Modal with callbacks: {hasHandleMoveCurrentDrawnCardToHand: true, hasHandleSellCurrentDrawnCard: true}
[BROWSER] [MultiplayerGame] artifactSelectorPlayer lookup: {artifactSelectorPlayerId: , playersCount: 1, playerIds: Array(1), foundPlayer: undefined, playerName: undefined}
[BROWSER] [MultiplayerGame] Rendering PlayersFieldArea in Modal with callbacks: {hasHandleMoveCurrentDrawnCardToHand: true, hasHandleSellCurrentDrawnCard: true}
[TEST] Game loaded

[TEST] PHASE 2: Handling artifacts

[TEST] PHASE 3: Selecting market cards
[TEST] Reached ACTION phase

[TEST] PHASE 4: Setting up field with F002 cards
[BROWSER] [MultiplayerGame] Rendering PlayersFieldArea in Modal with callbacks: {hasHandleMoveCurrentDrawnCardToHand: true, hasHandleSellCurrentDrawnCard: true}
[BROWSER] [MultiplayerGame] Rendering PlayersFieldArea in Modal with callbacks: {hasHandleMoveCurrentDrawnCardToHand: true, hasHandleSellCurrentDrawnCard: true}
[BROWSER] [MultiplayerGame] Dev-taming card directly to field (will trigger ON_TAME): {instanceId: F002_test_1767568124002_mqfrbbwnm, cardId: F002, name: Imp, nameTw: Â∞èÊÉ°È≠î, element: FIRE}
[BROWSER] [MultiplayerGame] Game update: {status: HUNTING, currentPlayerIndex: 0, isComplete: undefined}
[BROWSER] [MultiplayerGame] artifactSelectorPlayer lookup: {artifactSelectorPlayerId: , playersCount: 1, playerIds: Array(1), foundPlayer: undefined, playerName: undefined}
[BROWSER] [MultiplayerGame] Rendering PlayersFieldArea in Modal with callbacks: {hasHandleMoveCurrentDrawnCardToHand: true, hasHandleSellCurrentDrawnCard: true}
[BROWSER] [MultiplayerGame] artifactSelectorPlayer lookup: {artifactSelectorPlayerId: , playersCount: 1, playerIds: Array(1), foundPlayer: undefined, playerName: undefined}
[BROWSER] [MultiplayerGame] Rendering PlayersFieldArea in Modal with callbacks: {hasHandleMoveCurrentDrawnCardToHand: true, hasHandleSellCurrentDrawnCard: true}
[BROWSER] [MultiplayerGame] Card added to field, now processing ON_TAME effects...
[BROWSER] [MultiplayerGame] Calling EffectProcessor.processOnTameEffects()...
[BROWSER] [EffectProcessor] ========== processOnTameEffects START ==========
[BROWSER] [EffectProcessor] Card instance ID: F002_test_1767568124002_mqfrbbwnm
[BROWSER] [EffectProcessor] Card: {baseScore: 2, cardId: F002, cost: 1, element: FIRE, hasUsedAbility: false}
[BROWSER] [EffectProcessor] Template: Â∞èÊÉ°È≠î F002
[BROWSER] [EffectProcessor] ON_TAME effects found: 1
[BROWSER] [EffectProcessor] Processing effect: EARN_STONES isImplemented: true
[BROWSER] [EffectProcessor] processEarnStones called
[BROWSER] [EffectProcessor] effect.stones: [Object]
[BROWSER] [EffectProcessor] Processing stone: type=ONE, amount=2
[BROWSER] [EffectProcessor] Total stones to gain: {ONE: 2}
[BROWSER] [EffectProcessor] Current stones BEFORE: {EARTH: 0, FIRE: 0, ONE: 0, SIX: 0, THREE: 0}
[BROWSER] [EffectProcessor] Adding 2 to ONE: 0 ‚Üí 2
[BROWSER] [EffectProcessor] Updated stones AFTER: {EARTH: 0, FIRE: 0, ONE: 2, SIX: 0, THREE: 0}
[BROWSER] [MultiplayerGame] Game update: {status: HUNTING, currentPlayerIndex: 0, isComplete: undefined}
[BROWSER] [MultiplayerGame] artifactSelectorPlayer lookup: {artifactSelectorPlayerId: , playersCount: 1, playerIds: Array(1), foundPlayer: undefined, playerName: undefined}
[BROWSER] [MultiplayerGame] Rendering PlayersFieldArea in Modal with callbacks: {hasHandleMoveCurrentDrawnCardToHand: true, hasHandleSellCurrentDrawnCard: true}
[BROWSER] [MultiplayerGame] artifactSelectorPlayer lookup: {artifactSelectorPlayerId: , playersCount: 1, playerIds: Array(1), foundPlayer: undefined, playerName: undefined}
[BROWSER] [MultiplayerGame] Rendering PlayersFieldArea in Modal with callbacks: {hasHandleMoveCurrentDrawnCardToHand: true, hasHandleSellCurrentDrawnCard: true}
[BROWSER] [EffectProcessor] ‚úÖ Firebase updated successfully
[BROWSER] [EffectProcessor] Effect result: {success: true, stonesGained: Object, message: Gained stones: {"ONE":2}}
[BROWSER] [EffectProcessor] ========== processOnTameEffects END ==========
[BROWSER] [EffectProcessor] Total results: 1
[BROWSER] [MultiplayerGame] ON_TAME effect results: [Object]
[BROWSER] [MultiplayerGame] ‚úÖ Card tamed successfully with ON_TAME effects triggered!
[TEST] Directly tamed F002
[BROWSER] [MultiplayerGame] Dev-taming card directly to field (will trigger ON_TAME): {instanceId: F002_test_1767568127406_5gotpn7kn, cardId: F002, name: Imp, nameTw: Â∞èÊÉ°È≠î, element: FIRE}
[BROWSER] [MultiplayerGame] Game update: {status: HUNTING, currentPlayerIndex: 0, isComplete: undefined}
[BROWSER] [MultiplayerGame] artifactSelectorPlayer lookup: {artifactSelectorPlayerId: , playersCount: 1, playerIds: Array(1), foundPlayer: undefined, playerName: undefined}
[BROWSER] [MultiplayerGame] Rendering PlayersFieldArea in Modal with callbacks: {hasHandleMoveCurrentDrawnCardToHand: true, hasHandleSellCurrentDrawnCard: true}
[BROWSER] [MultiplayerGame] artifactSelectorPlayer lookup: {artifactSelectorPlayerId: , playersCount: 1, playerIds: Array(1), foundPlayer: undefined, playerName: undefined}
[BROWSER] [MultiplayerGame] Rendering PlayersFieldArea in Modal with callbacks: {hasHandleMoveCurrentDrawnCardToHand: true, hasHandleSellCurrentDrawnCard: true}
[BROWSER] [MultiplayerGame] Card added to field, now processing ON_TAME effects...
[BROWSER] [MultiplayerGame] Calling EffectProcessor.processOnTameEffects()...
[BROWSER] [EffectProcessor] ========== processOnTameEffects START ==========
[BROWSER] [EffectProcessor] Card instance ID: F002_test_1767568127406_5gotpn7kn
[BROWSER] [EffectProcessor] Card: {baseScore: 2, cardId: F002, cost: 1, element: FIRE, hasUsedAbility: false}
[BROWSER] [EffectProcessor] Template: Â∞èÊÉ°È≠î F002
[BROWSER] [EffectProcessor] ON_TAME effects found: 1
[BROWSER] [EffectProcessor] Processing effect: EARN_STONES isImplemented: true
[BROWSER] [EffectProcessor] processEarnStones called
[BROWSER] [EffectProcessor] effect.stones: [Object]
[BROWSER] [EffectProcessor] Processing stone: type=ONE, amount=2
[BROWSER] [EffectProcessor] Total stones to gain: {ONE: 2}
[BROWSER] [EffectProcessor] Current stones BEFORE: {EARTH: 0, FIRE: 0, ONE: 2, SIX: 0, THREE: 0}
[BROWSER] [EffectProcessor] Adding 2 to ONE: 2 ‚Üí 4
[BROWSER] [EffectProcessor] Updated stones AFTER: {EARTH: 0, FIRE: 0, ONE: 4, SIX: 0, THREE: 0}
[BROWSER] [MultiplayerGame] Game update: {status: HUNTING, currentPlayerIndex: 0, isComplete: undefined}
[BROWSER] [MultiplayerGame] artifactSelectorPlayer lookup: {artifactSelectorPlayerId: , playersCount: 1, playerIds: Array(1), foundPlayer: undefined, playerName: undefined}
[BROWSER] [MultiplayerGame] Rendering PlayersFieldArea in Modal with callbacks: {hasHandleMoveCurrentDrawnCardToHand: true, hasHandleSellCurrentDrawnCard: true}
[BROWSER] [MultiplayerGame] artifactSelectorPlayer lookup: {artifactSelectorPlayerId: , playersCount: 1, playerIds: Array(1), foundPlayer: undefined, playerName: undefined}
[BROWSER] [MultiplayerGame] Rendering PlayersFieldArea in Modal with callbacks: {hasHandleMoveCurrentDrawnCardToHand: true, hasHandleSellCurrentDrawnCard: true}
[BROWSER] [EffectProcessor] ‚úÖ Firebase updated successfully
[BROWSER] [EffectProcessor] Effect result: {success: true, stonesGained: Object, message: Gained stones: {"ONE":2}}
[BROWSER] [EffectProcessor] ========== processOnTameEffects END ==========
[BROWSER] [EffectProcessor] Total results: 1
[BROWSER] [MultiplayerGame] ON_TAME effect results: [Object]
[BROWSER] [MultiplayerGame] ‚úÖ Card tamed successfully with ON_TAME effects triggered!
[TEST] Directly tamed F002
[TEST] Cards in field: 0

[TEST] PHASE 5: Taming F007 (Ifrit)
[BROWSER] [MultiplayerGame] disabledArtifacts calculation: {sanctuaryCount: 0, hasSanctuaryCards: false, disabled: Array(1)}
[BROWSER] [MultiplayerGame] artifactSelectorPlayer lookup: {artifactSelectorPlayerId: , playersCount: 1, playerIds: Array(1), foundPlayer: undefined, playerName: undefined}
[BROWSER] [MultiplayerGame] Rendering PlayersFieldArea in Modal with callbacks: {hasHandleMoveCurrentDrawnCardToHand: true, hasHandleSellCurrentDrawnCard: true}
[BROWSER] [MultiplayerGame] disabledArtifacts calculation: {sanctuaryCount: 0, hasSanctuaryCards: false, disabled: Array(1)}
[BROWSER] [MultiplayerGame] artifactSelectorPlayer lookup: {artifactSelectorPlayerId: , playersCount: 1, playerIds: Array(1), foundPlayer: undefined, playerName: undefined}
[BROWSER] [MultiplayerGame] Rendering PlayersFieldArea in Modal with callbacks: {hasHandleMoveCurrentDrawnCardToHand: true, hasHandleSellCurrentDrawnCard: true}
[BROWSER] [MultiplayerGame] Setting up Firebase listeners for game: game_1767568119539_kf9hyes2w
[BROWSER] [MultiplayerGame] Game update: {status: HUNTING, currentPlayerIndex: 0, isComplete: undefined}
[BROWSER] [MultiplayerGame] artifactSelectorPlayer lookup: {artifactSelectorPlayerId: , playersCount: 1, playerIds: Array(1), foundPlayer: undefined, playerName: undefined}
[BROWSER] [MultiplayerGame] Rendering PlayersFieldArea in Modal with callbacks: {hasHandleMoveCurrentDrawnCardToHand: true, hasHandleSellCurrentDrawnCard: true}
[BROWSER] [MultiplayerGame] artifactSelectorPlayer lookup: {artifactSelectorPlayerId: , playersCount: 1, playerIds: Array(1), foundPlayer: undefined, playerName: undefined}
[BROWSER] [MultiplayerGame] Rendering PlayersFieldArea in Modal with callbacks: {hasHandleMoveCurrentDrawnCardToHand: true, hasHandleSellCurrentDrawnCard: true}
[TEST] Stones BEFORE: 0
[BROWSER] [MultiplayerGame] Dev-taming card directly to field (will trigger ON_TAME): {instanceId: F007_test_1767568141344_zkdgdwtvq, cardId: F007, name: Ifrit, nameTw: ‰ºäÂ§´Âà©Áâπ, element: FIRE}
[BROWSER] [MultiplayerGame] Game update: {status: HUNTING, currentPlayerIndex: 0, isComplete: undefined}
[BROWSER] [MultiplayerGame] artifactSelectorPlayer lookup: {artifactSelectorPlayerId: , playersCount: 1, playerIds: Array(1), foundPlayer: undefined, playerName: undefined}
[BROWSER] [MultiplayerGame] Rendering PlayersFieldArea in Modal with callbacks: {hasHandleMoveCurrentDrawnCardToHand: true, hasHandleSellCurrentDrawnCard: true}
[BROWSER] [MultiplayerGame] artifactSelectorPlayer lookup: {artifactSelectorPlayerId: , playersCount: 1, playerIds: Array(1), foundPlayer: undefined, playerName: undefined}
[BROWSER] [MultiplayerGame] Rendering PlayersFieldArea in Modal with callbacks: {hasHandleMoveCurrentDrawnCardToHand: true, hasHandleSellCurrentDrawnCard: true}
[BROWSER] [MultiplayerGame] Card added to field, now processing ON_TAME effects...
[BROWSER] [MultiplayerGame] Calling EffectProcessor.processOnTameEffects()...
[BROWSER] [EffectProcessor] ========== processOnTameEffects START ==========
[BROWSER] [EffectProcessor] Card instance ID: F007_test_1767568141344_zkdgdwtvq
[BROWSER] [EffectProcessor] Card: {baseScore: 6, cardId: F007, cost: 2, element: FIRE, hasUsedAbility: false}
[BROWSER] [EffectProcessor] Template: ‰ºäÂ§´Âà©Áâπ F007
[BROWSER] [EffectProcessor] ON_TAME effects found: 1
[BROWSER] [EffectProcessor] Processing effect: CONDITIONAL_AREA isImplemented: true
[BROWSER] [MultiplayerGame] Failed to dev-tame card: TypeError: Cannot read properties of undefined (reading 'field')
    at EffectProcessor.processConditionalArea (http://localhost:5174/the-vale-of-eternity/src/services/effect-processor.ts?t=1767567884582:398:43)
    at EffectProcessor.processEffect (http://localhost:5174/the-vale-of-eternity/src/services/effect-processor.ts?t=1767567884582:74:21)
    at EffectProcessor.processOnTameEffects (http://localhost:5174/the-vale-of-eternity/src/services/effect-processor.ts?t=1767567884582:35:33)
    at http://localhost:5174/the-vale-of-eternity/src/pages/MultiplayerGame.tsx?t=1767568131428:1831:51
[TEST] Directly tamed F007
[BROWSER] [MultiplayerGame] disabledArtifacts calculation: {sanctuaryCount: 0, hasSanctuaryCards: false, disabled: Array(1)}
[BROWSER] [MultiplayerGame] artifactSelectorPlayer lookup: {artifactSelectorPlayerId: , playersCount: 1, playerIds: Array(1), foundPlayer: undefined, playerName: undefined}
[BROWSER] [MultiplayerGame] Rendering PlayersFieldArea in Modal with callbacks: {hasHandleMoveCurrentDrawnCardToHand: true, hasHandleSellCurrentDrawnCard: true}
[BROWSER] [MultiplayerGame] disabledArtifacts calculation: {sanctuaryCount: 0, hasSanctuaryCards: false, disabled: Array(1)}
[BROWSER] [MultiplayerGame] artifactSelectorPlayer lookup: {artifactSelectorPlayerId: , playersCount: 1, playerIds: Array(1), foundPlayer: undefined, playerName: undefined}
[BROWSER] [MultiplayerGame] Rendering PlayersFieldArea in Modal with callbacks: {hasHandleMoveCurrentDrawnCardToHand: true, hasHandleSellCurrentDrawnCard: true}
[BROWSER] [MultiplayerGame] Setting up Firebase listeners for game: game_1767568119539_kf9hyes2w
[BROWSER] [MultiplayerGame] Game update: {status: HUNTING, currentPlayerIndex: 0, isComplete: undefined}
[BROWSER] [MultiplayerGame] artifactSelectorPlayer lookup: {artifactSelectorPlayerId: , playersCount: 1, playerIds: Array(1), foundPlayer: undefined, playerName: undefined}
[BROWSER] [MultiplayerGame] Rendering PlayersFieldArea in Modal with callbacks: {hasHandleMoveCurrentDrawnCardToHand: true, hasHandleSellCurrentDrawnCard: true}
[BROWSER] [MultiplayerGame] artifactSelectorPlayer lookup: {artifactSelectorPlayerId: , playersCount: 1, playerIds: Array(1), foundPlayer: undefined, playerName: undefined}
[BROWSER] [MultiplayerGame] Rendering PlayersFieldArea in Modal with callbacks: {hasHandleMoveCurrentDrawnCardToHand: true, hasHandleSellCurrentDrawnCard: true}
[TEST] Stones AFTER: 0
[TEST] Expected gain: 0 (0 cards √ó 1 stone)
[TEST] Actual gain: 0

[TEST] ‚úÖ F007 ON_TAME TEST PASSED
========================================
ON_TAME: Earned 0 stones for 0 cards ‚úÖ
========================================
  ‚úò  1 [chromium] ‚Ä∫ tests\e2e\cards\F007-ifrit-simple.spec.ts:108:3 ‚Ä∫ F007 - ‰ºäÂ§´Âà©Áâπ - ON_TAME Test ‚Ä∫ ON_TAME: Earn 1 stone per card in area (30.1s)


  1) [chromium] ‚Ä∫ tests\e2e\cards\F007-ifrit-simple.spec.ts:108:3 ‚Ä∫ F007 - ‰ºäÂ§´Âà©Áâπ - ON_TAME Test ‚Ä∫ ON_TAME: Earn 1 stone per card in area 

    [31mTest timeout of 30000ms exceeded.[39m

    attachment #1: screenshot (image/png) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    test-results\cards-F007-ifrit-simple-F0-e326a-rn-1-stone-per-card-in-area-chromium\test-failed-1.png
    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

    Error Context: test-results\cards-F007-ifrit-simple-F0-e326a-rn-1-stone-per-card-in-area-chromium\error-context.md

  1 failed
    [chromium] ‚Ä∫ tests\e2e\cards\F007-ifrit-simple.spec.ts:108:3 ‚Ä∫ F007 - ‰ºäÂ§´Âà©Áâπ - ON_TAME Test ‚Ä∫ ON_TAME: Earn 1 stone per card in area 
